<!DOCTYPE html>
<html>
<head>	
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<title>Twlyr - Share a Song!</title>

	<link href="bootstrap/css/bootstrap.css" rel="stylesheet"></link>
	<link href='main.css' rel='stylesheet' type='text/css'>
	<link href='http://fonts.googleapis.com/css?family=Berkshire+Swash|Courgette' rel='stylesheet' type='text/css'>

	<script src="js/jquery.min.js" charset="utf-8"></script>
	<script src="js/vagalume.js" charset="utf-8"></script>
	<script src="js/selector.js" charset="utf-8"></script>
	<script src="js/tweet.js" charset="utf-8"></script>

	<style>

		.box.left {
			width: 380px;
			float: left;
			padding: 10px 0;
		}

		.box.right {
			float: right;
			width: 400px;
		}

	</style>

	<style>
	.container { margin-top: 50px; }
	</style>

</head>
<body>

<div class="container">


	<div class="inline-search-bar">
		<div class="twlyr medium">Twlyr</div>
		<div id="searchbar">
			<form class="form-search">
				<input type="text" placeholder="choose an artist" class="input-medium search-query" id="search-artist">
				<input type="text" placeholder="choose a song" class="input-medium search-query" id="search-music">
				<button type="submit" class="btn btn-warning btn-large">Search</button>
			</form>
		</div>
	</div>
	
	<div id="content">
	</div>

</div>

<script>

$('#search-artist').val('Coldplay');
$('#search-music').val('The Scientist');

document.querySelector('#searchbar form').onsubmit = function () {
	var artist = encodeURIComponent(document.querySelector('#search-artist').value);
	var music = encodeURIComponent(document.querySelector('#search-music').value);
	window.location.hash = '#!search:' + artist + ':' + music;
	return false;
}

(function (){
	var parseHash = function (hash) {
		var ret = 'default';
		if (!hash || hash.length < 4 || hash.slice(0, 2) !== '#!')
			return ret;
		return hash.slice(2).split(':')[0];
	};
	var currentHash = false;
	setInterval(function () {
		if (window.location.hash !== currentHash) {
			var pagename = parseHash(window.location.hash);
			currentHash = window.location.hash;
			$('#content').html('');
			$.ajax({
				url: pagename + '.html',
				async: true,
				cache: true,
				error: function (){
					console.log('ajax error');
				},
				type: 'GET',
				dataType: 'html',
				timeout: 10000,
				success: function (html) {
					$('#content').html(html);
					$.ajax({
						url: pagename + '.js',
						async: true,
						cache: true,
						error: function (){
							console.log('ajax error');
						},
						type: 'GET',
						dataType: 'script',
						timeout: 10000,
					});
				},
			});
		}
	}, 100);
}());

</script>
</body>
</html>