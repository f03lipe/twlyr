<!DOCTYPE html>
<html>
<head>	
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<title>Twlyr - Share a Song!</title>

	<link href="bootstrap/css/bootstrap.css" rel="stylesheet"></link>
	<link href='main.css' rel='stylesheet' type='text/css'>
	<link href='http://fonts.googleapis.com/css?family=Berkshire+Swash|Courgette' rel='stylesheet' type='text/css'>

	<script src="js/jquery.min.js" charset="utf-8"></script>
	<script src="js/vagalume.js" charset="utf-8"></script>
	<script src="js/selector.js" charset="utf-8"></script>

	<style>
	.container { margin-top: 200px; }
	</style>
</head>
<body>

<div class="beta-strip">Beta v1.0</div>

<div class="container">

	<h1 class="twlyr">Twlyr</h1>
	<h3 class="desc">share a verse on Twitter!</h3>
	
	<div>
		<div id="searchbar">
			<form class="form-search">
				<input type="text" placeholder="choose an artist" class="input-medium search-query" id="search-artist">
				<input type="text" placeholder="choose a song" class="input-medium search-query" id="search-music">
				<button type="submit" class="btn btn-warning btn-large">Search</button>
			</form>
		</div>
	</div>

	<footer>
		2012 &reg created by <a href="#">@f03lipe</a> and <a href="#">@gabrielvianna</a>
	</footer>

	<!--
	<div class="blackout">
		<div>
			<img src="images/loading.gif"></img>
		</div>
	</div>
	-->
	
</div>
<script>

$('#search-artist').val('Coldplay');
$('#search-music').val('The Scientist');

$('#searchbar form').submit(function (){
	var artist = encodeURIComponent($('#search-artist').val());
	var music = encodeURIComponent($('#search-music').val());
	window.location.hash = '#!search:' + artist + ':' + music;
	return false;
});

(function (){
	var parseHash = function (hash) {
		var ret = 'default';
		if (!hash || hash.length < 4 || hash.slice(0, 2) !== '#!')
			return ret;
		return hash.slice(2).split(':')[0];
	};
	var currentHash = false;
	setInterval(function () {
		if (window.location.hash !== currentHash) {
			var pagename = parseHash(window.location.hash);
			currentHash = window.location.hash;
			$('#content').html('');
			$.ajax({
				url: pagename + '.html',
				async: true,
				cache: true,
				error: function (){
					console.log('ajax error');
				},
				type: 'GET',
				dataType: 'html',
				timeout: 10000,
				success: function (html) {
					$('#content').html(html);
					$.ajax({
						url: pagename + '.js',
						async: true,
						cache: true,
						error: function (){
							console.log('ajax error');
						},
						type: 'GET',
						dataType: 'script',
						timeout: 10000,
					});
				},
			});
		}
	}, 100);
}());

</script>

</body>
</html>